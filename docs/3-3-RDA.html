<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.3 Análisis Discriminante Regularizado | Introducción al Aprendizaje Supervisado" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Sesiones 13-15 IV Edición del Big Analytics: de la información al conocimiento." />


<meta name="author" content="Harold A. Hernández-Roig (hahernan@est-econ.uc3m.es)" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Sesiones 13-15 IV Edición del Big Analytics: de la información al conocimiento.">

<title>3.3 Análisis Discriminante Regularizado | Introducción al Aprendizaje Supervisado</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#introducción"><span class="toc-section-number">1</span> Introducción</a></li>
<li class="has-sub"><a href="2-k-vecinos-más-próximos.html#k---vecinos-más-próximos"><span class="toc-section-number">2</span> K - Vecinos más Próximos</a><ul>
<li><a href="2-1-clasificación-con-el-paquete-class.html#clasificación-con-el-paquete-class"><span class="toc-section-number">2.1</span> Clasificación con el paquete <code>class</code></a></li>
<li class="has-sub"><a href="2-2-el-paquete-caret.html#el-paquete-caret"><span class="toc-section-number">2.2</span> El paquete <code>caret</code></a><ul>
<li><a href="2-2-el-paquete-caret.html#visualización"><span class="toc-section-number">2.2.1</span> Visualización</a></li>
<li><a href="2-2-el-paquete-caret.html#clasificación-con-knn"><span class="toc-section-number">2.2.2</span> Clasificación con KNN</a></li>
<li><a href="2-2-el-paquete-caret.html#importancia-de-las-variables"><span class="toc-section-number">2.2.3</span> Importancia de las variables</a></li>
</ul></li>
<li><a href="2-3-regresión.html#regresión"><span class="toc-section-number">2.3</span> Regresión</a></li>
<li><a href="2-4-weighted-knn.html#weighted-knn"><span class="toc-section-number">2.4</span> Weighted KNN</a></li>
</ul></li>
<li class="has-sub"><a href="3-DA.html#DA"><span class="toc-section-number">3</span> Análisis Discriminante</a><ul>
<li><a href="3-1-LDA.html#LDA"><span class="toc-section-number">3.1</span> Análisis Discriminante Lineal</a></li>
<li><a href="3-2-QDA.html#QDA"><span class="toc-section-number">3.2</span> Análisis Discriminante Cuadrático</a></li>
<li><a href="3-3-RDA.html#RDA"><span class="toc-section-number">3.3</span> Análisis Discriminante Regularizado</a></li>
</ul></li>
<li class="has-sub"><a href="4-compara.html#compara"><span class="toc-section-number">4</span> Comparación entre Modelos</a><ul>
<li><a href="4-1-comparando-según-accuracy.html#comparando-según-accuracy"><span class="toc-section-number">4.1</span> Comparando según <code>Accuracy</code></a></li>
<li class="has-sub"><a href="4-2-curva-roc.html#curva-roc"><span class="toc-section-number">4.2</span> Curva <em>ROC</em></a><ul>
<li><a href="4-2-curva-roc.html#análisis-en-la-muestra-test"><span class="toc-section-number">4.2.1</span> Análisis en la muestra test</a></li>
<li><a href="4-2-curva-roc.html#análisis-en-la-muestra-de-entrenamiento"><span class="toc-section-number">4.2.2</span> Análisis en la muestra de entrenamiento</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-wiscon.html#wiscon"><span class="toc-section-number">5</span> Wisconsin Breast-Cancer Data</a><ul>
<li><a href="5-1-comentarios-finales-reducción-de-la-dimensión.html#comentarios-finales-reducción-de-la-dimensión"><span class="toc-section-number">5.1</span> Comentarios finales: reducción de la dimensión</a></li>
</ul></li>
<li><a href="bibliografía.html#bibliografía">Bibliografía</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="RDA" class="section level2">
<h2><span class="header-section-number">3.3</span> Análisis Discriminante Regularizado</h2>
<p><strong>Opción 1</strong>: el paquete <code>caret</code> crea el grid para <span class="math inline">\((\lambda, \gamma)\)</span>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2">model_rda_def &lt;-<span class="st"> </span><span class="kw">train</span>(default <span class="op">~</span>.,</a>
<a class="sourceLine" id="cb108-3" data-line-number="3">                       <span class="dt">data =</span> train_df,</a>
<a class="sourceLine" id="cb108-4" data-line-number="4">                       <span class="dt">method =</span> <span class="st">&quot;rda&quot;</span>,</a>
<a class="sourceLine" id="cb108-5" data-line-number="5">                       <span class="dt">tuneLength =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb108-6" data-line-number="6">                       <span class="dt">trControl =</span> fit_control)</a>
<a class="sourceLine" id="cb108-7" data-line-number="7"></a>
<a class="sourceLine" id="cb108-8" data-line-number="8">model_rda_def</a></code></pre></div>
<pre><code>## Regularized Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results across tuning parameters:
## 
##   gamma  lambda  Accuracy   Kappa    
##   0      0       0.9730043  0.3787741
##   0      1       0.9733790  0.3710518
##   1      0       0.9666297  0.0000000
##   1      1       0.9666297  0.0000000
## 
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were gamma = 0 and lambda = 1.</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">model_rda_def<span class="op">$</span>finalModel</a></code></pre></div>
<pre><code>## Call: 
## rda.default(x = x, grouping = y, gamma = param$gamma, lambda = param$lambda)
## 
## Regularization parameters: 
##  gamma lambda 
##      0      1 
## 
## Prior probabilities of groups: 
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Misclassification rate: 
##        apparent: 2.662 %</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="co"># en este caso el ggplot nos da información sobre los </span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="co"># hiperparametros y su correspondiente Accuracy</span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="kw">ggplot</span>(model_rda_def) <span class="op">+</span><span class="st"> </span><span class="kw">theme_light</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-48-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Opción 2</strong>: podemos proporcionar un grid predefinido de valores <span class="math inline">\((\lambda, \gamma)\)</span> en un <code>data.frame</code> que le pasamos a <code>tuneGrid</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="co"># el grid se puede definir tambien &quot;a mano&quot;</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2">mi.grid &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lambda =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="dv">1</span>) , </a>
<a class="sourceLine" id="cb113-3" data-line-number="3">                       <span class="dt">gamma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb113-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb113-5" data-line-number="5">model_rda_def &lt;-<span class="st"> </span><span class="kw">train</span>(default <span class="op">~</span>.,</a>
<a class="sourceLine" id="cb113-6" data-line-number="6">                       <span class="dt">data =</span> train_df,</a>
<a class="sourceLine" id="cb113-7" data-line-number="7">                       <span class="dt">method =</span> <span class="st">&quot;rda&quot;</span>,</a>
<a class="sourceLine" id="cb113-8" data-line-number="8">                       <span class="dt">tuneGrid =</span> mi.grid,</a>
<a class="sourceLine" id="cb113-9" data-line-number="9">                       <span class="dt">trControl =</span> fit_control)</a>
<a class="sourceLine" id="cb113-10" data-line-number="10">model_rda_def</a></code></pre></div>
<pre><code>## Regularized Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results across tuning parameters:
## 
##   lambda  Accuracy   Kappa    
##   0.0     0.9730043  0.3787741
##   0.3     0.9733790  0.3791078
##   0.6     0.9735039  0.3764691
##   1.0     0.9733790  0.3710518
## 
## Tuning parameter &#39;gamma&#39; was held constant at a value of 0
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were gamma = 0 and lambda = 0.6.</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1">model_rda_def<span class="op">$</span>finalModel</a></code></pre></div>
<pre><code>## Call: 
## rda.default(x = x, grouping = y, gamma = param$gamma, lambda = param$lambda)
## 
## Regularization parameters: 
##  gamma lambda 
##    0.0    0.6 
## 
## Prior probabilities of groups: 
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Misclassification rate: 
##        apparent: 2.675 %</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="co"># en este caso el ggplot nos da información sobre los </span></a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="co"># hiperparametros y su correspondiente Accuracy</span></a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="kw">ggplot</span>(model_rda_def) <span class="op">+</span><span class="st"> </span><span class="kw">theme_light</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-50-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Los resultados indican que los hiperparámetros óptimos en este caso corresponden a <span class="math inline">\((\lambda, \gamma) = (0,0)\)</span>. ¡Este es el caso del algoritmo LDA! Esto que hemos hecho es comparar diferentes modelos (porque han sido ajustados con diferentes hiperparámetros) resultantes del mismo algoritmo. Veamos las predicciones para la muestra test, la tasa de error correspondiente y la frontera de decisión.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="co"># hagamos las predicciones del conjunto de prueba</span></a>
<a class="sourceLine" id="cb118-2" data-line-number="2">prediction_rda_def &lt;-<span class="st"> </span><span class="kw">predict</span>(model_rda_def, <span class="dt">newdata =</span> test_df)</a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="kw">confusionMatrix</span>(prediction_rda_def, <span class="dt">reference =</span> test_df<span class="op">$</span>default)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   No  Yes
##        No  1926   52
##        Yes    7   14
##                                           
##                Accuracy : 0.9705          
##                  95% CI : (0.9621, 0.9775)
##     No Information Rate : 0.967           
##     P-Value [Acc &gt; NIR] : 0.2098          
##                                           
##                   Kappa : 0.3109          
##                                           
##  Mcnemar&#39;s Test P-Value : 1.014e-08       
##                                           
##             Sensitivity : 0.9964          
##             Specificity : 0.2121          
##          Pos Pred Value : 0.9737          
##          Neg Pred Value : 0.6667          
##              Prevalence : 0.9670          
##          Detection Rate : 0.9635          
##    Detection Prevalence : 0.9895          
##       Balanced Accuracy : 0.6042          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="co"># extraemos el Accuracy o Precisión</span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="kw">confusionMatrix</span>(prediction_rda_def, <span class="dt">reference =</span> test_df<span class="op">$</span>default)<span class="op">$</span>overall[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>##  Accuracy 
## 0.9704852</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="co"># la tasa de error</span></a>
<a class="sourceLine" id="cb122-2" data-line-number="2">tasa.error.rda &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">confusionMatrix</span>(prediction_rda_def, <span class="dt">reference =</span> test_df<span class="op">$</span>default)<span class="op">$</span>overall[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb122-3" data-line-number="3"><span class="kw">names</span>(tasa.error.rda) &lt;-<span class="st"> &quot;Error RDA&quot;</span></a>
<a class="sourceLine" id="cb122-4" data-line-number="4">tasa.error.rda</a></code></pre></div>
<pre><code>##  Error RDA 
## 0.02951476</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw">decision_bound</span>(train_df, test_df, model_rda_def)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="80%" style="display: block; margin: auto;" /></p>

</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="3-2-QDA.html"><button class="btn btn-default">Previous</button></a>
<a href="4-compara.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
