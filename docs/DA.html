<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Análisis Discriminante | Introducción al Aprendizaje Supervisado</title>
  <meta name="description" content="Big Analytics V" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Análisis Discriminante | Introducción al Aprendizaje Supervisado" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Big Analytics V" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Análisis Discriminante | Introducción al Aprendizaje Supervisado" />
  
  <meta name="twitter:description" content="Big Analytics V" />
  

<meta name="author" content="Harold A. Hernández-Roig (hahernan@est-econ.uc3m.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="k-vecinos-más-próximos.html"/>
<link rel="next" href="compara.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html"><i class="fa fa-check"></i><b>2</b> K - Vecinos más Próximos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#clasificación-con-el-paquete-class"><i class="fa fa-check"></i><b>2.1</b> Clasificación con el paquete <code>class</code></a></li>
<li class="chapter" data-level="2.2" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#el-paquete-caret"><i class="fa fa-check"></i><b>2.2</b> El paquete <code>caret</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#visualización"><i class="fa fa-check"></i><b>2.2.1</b> Visualización</a></li>
<li class="chapter" data-level="2.2.2" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#clasificación-con-knn"><i class="fa fa-check"></i><b>2.2.2</b> Clasificación con KNN</a></li>
<li class="chapter" data-level="2.2.3" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#importancia-de-las-variables"><i class="fa fa-check"></i><b>2.2.3</b> Importancia de las variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#regresión"><i class="fa fa-check"></i><b>2.3</b> Regresión</a></li>
<li class="chapter" data-level="2.4" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#weighted-knn"><i class="fa fa-check"></i><b>2.4</b> Weighted KNN</a></li>
<li class="chapter" data-level="2.5" data-path="k-vecinos-más-próximos.html"><a href="k-vecinos-más-próximos.html#procesamiento-en-paralelo"><i class="fa fa-check"></i><b>2.5</b> Procesamiento en paralelo</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DA.html"><a href="DA.html"><i class="fa fa-check"></i><b>3</b> Análisis Discriminante</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DA.html"><a href="DA.html#LDA"><i class="fa fa-check"></i><b>3.1</b> Análisis Discriminante Lineal</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DA.html"><a href="DA.html#frontera-de-decisión-en-2d"><i class="fa fa-check"></i><b>3.1.1</b> Frontera de decisión en 2D</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DA.html"><a href="DA.html#QDA"><i class="fa fa-check"></i><b>3.2</b> Análisis Discriminante Cuadrático</a></li>
<li class="chapter" data-level="3.3" data-path="DA.html"><a href="DA.html#RDA"><i class="fa fa-check"></i><b>3.3</b> Análisis Discriminante Regularizado</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="compara.html"><a href="compara.html"><i class="fa fa-check"></i><b>4</b> Comparación entre Modelos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="compara.html"><a href="compara.html#comparando-según-accuracy"><i class="fa fa-check"></i><b>4.1</b> Comparando según <code>Accuracy</code></a></li>
<li class="chapter" data-level="4.2" data-path="compara.html"><a href="compara.html#curva-roc"><i class="fa fa-check"></i><b>4.2</b> Curva <em>ROC</em></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="compara.html"><a href="compara.html#análisis-en-la-muestra-test"><i class="fa fa-check"></i><b>4.2.1</b> Análisis en la muestra test</a></li>
<li class="chapter" data-level="4.2.2" data-path="compara.html"><a href="compara.html#análisis-en-la-muestra-de-entrenamiento"><i class="fa fa-check"></i><b>4.2.2</b> Análisis en la muestra de entrenamiento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wiscon.html"><a href="wiscon.html"><i class="fa fa-check"></i><b>5</b> Wisconsin Breast-Cancer Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="wiscon.html"><a href="wiscon.html#reducción-de-la-dimensión"><i class="fa fa-check"></i><b>5.1</b> Reducción de la dimensión</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción al Aprendizaje Supervisado</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="DA" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Análisis Discriminante</h1>
<p>En esta sección nos concentramos en el problema de clasificación. Particularmente, estudiaremos los métodos de <em>Análisis Discriminante Lineal (LDA)</em>, <em>Cuadrático (QDA)</em> y <em>Regularizado (RDA)</em>. Usaremos el conjunto de datos <code>Default</code> del paquete <code>ISLR</code>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="DA.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb85-2"><a href="DA.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb85-3"><a href="DA.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="DA.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Default&quot;</span>)</span>
<span id="cb85-5"><a href="DA.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Default, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    default student   balance    income
## 1       No      No  729.5265 44361.625
## 2       No     Yes  817.1804 12106.135
## 3       No      No 1073.5492 31767.139
## 4       No      No  529.2506 35704.494
## 5       No      No  785.6559 38463.496
## 6       No     Yes  919.5885  7491.559
## 7       No      No  825.5133 24905.227
## 8       No     Yes  808.6675 17600.451
## 9       No      No 1161.0579 37468.529
## 10      No      No    0.0000 29275.268</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="DA.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Default)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    10000 obs. of  4 variables:
##  $ default: Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ student: Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 2 1 1 1 2 1 2 1 1 ...
##  $ balance: num  730 817 1074 529 786 ...
##  $ income : num  44362 12106 31767 35704 38463 ...</code></pre>
<p>El objetivo es predecir si un sujeto de la muestra fallará en el pago de su tarjeta de crédito. Por tanto, la variable respuesta es <code>default</code>, categórica con solo los niveles <code>Yes</code> y <code>No</code>. Tenemos información sobre el balance mensual de crédito en <code>balance</code>, el salario anual en <code>income</code> y si es estudiante o no en <code>student</code>. Solo un <span class="math inline">\(3\%\)</span> de la muestra es de la clase <code>Yes</code>, así que está bastante desbalanceada.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="DA.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Default)</span></code></pre></div>
<pre><code>##  default    student       balance           income     
##  No :9667   No :7056   Min.   :   0.0   Min.   :  772  
##  Yes: 333   Yes:2944   1st Qu.: 481.7   1st Qu.:21340  
##                        Median : 823.6   Median :34553  
##                        Mean   : 835.4   Mean   :33517  
##                        3rd Qu.:1166.3   3rd Qu.:43808  
##                        Max.   :2654.3   Max.   :73554</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="DA.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ver el balance de la muestra</span></span>
<span id="cb91-2"><a href="DA.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(Default<span class="sc">$</span>default))</span></code></pre></div>
<pre><code>## 
##     No    Yes 
## 0.9667 0.0333</code></pre>
<p>Nos concentramos en predecir <code>default</code> a partir de las variables predictoras <code>balance</code> e <code>income</code>. En el siguiente diagrama de dispersión se observa cierto solapamiento entre las clases a predecir, pero una clara diferenciación de acuerdo a la variable <code>balance</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="DA.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb93-2"><a href="DA.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb93-3"><a href="DA.html#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="DA.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Scatter plot con densidades ----</span></span>
<span id="cb93-5"><a href="DA.html#cb93-5" aria-hidden="true" tabindex="-1"></a>plot<span class="fl">.2</span>d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> balance, <span class="at">y =</span> income, <span class="at">group =</span> default)) <span class="sc">+</span></span>
<span id="cb93-6"><a href="DA.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> default, <span class="at">color =</span> default), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="DA.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb93-8"><a href="DA.html#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="DA.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty plot</span></span>
<span id="cb93-10"><a href="DA.html#cb93-10" aria-hidden="true" tabindex="-1"></a>empty <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb93-11"><a href="DA.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb93-12"><a href="DA.html#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-13"><a href="DA.html#cb93-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-14"><a href="DA.html#cb93-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-15"><a href="DA.html#cb93-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-16"><a href="DA.html#cb93-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-17"><a href="DA.html#cb93-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-18"><a href="DA.html#cb93-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-19"><a href="DA.html#cb93-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-20"><a href="DA.html#cb93-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb93-21"><a href="DA.html#cb93-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb93-22"><a href="DA.html#cb93-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-23"><a href="DA.html#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="co"># arriba</span></span>
<span id="cb93-24"><a href="DA.html#cb93-24" aria-hidden="true" tabindex="-1"></a>dens.balance <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> balance, <span class="at">group =</span> default)) <span class="sc">+</span></span>
<span id="cb93-25"><a href="DA.html#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> default, <span class="at">fill =</span> default), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb93-26"><a href="DA.html#cb93-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()<span class="sc">+</span></span>
<span id="cb93-27"><a href="DA.html#cb93-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb93-28"><a href="DA.html#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="co"># derecha</span></span>
<span id="cb93-29"><a href="DA.html#cb93-29" aria-hidden="true" tabindex="-1"></a>dens.income <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Default, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">group =</span> default)) <span class="sc">+</span></span>
<span id="cb93-30"><a href="DA.html#cb93-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> default, <span class="at">fill =</span> default), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb93-31"><a href="DA.html#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb93-32"><a href="DA.html#cb93-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb93-33"><a href="DA.html#cb93-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-34"><a href="DA.html#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(dens.balance, empty, plot<span class="fl">.2</span>d, dens.income, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">widths=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">heights=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="LDA" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Análisis Discriminante Lineal</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="DA.html#cb94-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> Default[, <span class="fu">c</span>(<span class="st">&quot;income&quot;</span>, <span class="st">&quot;balance&quot;</span>, <span class="st">&quot;default&quot;</span>)]</span>
<span id="cb94-2"><a href="DA.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb94-3"><a href="DA.html#cb94-3" aria-hidden="true" tabindex="-1"></a>train.ID <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(df<span class="sc">$</span>default, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-4"><a href="DA.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="DA.html#cb94-5" aria-hidden="true" tabindex="-1"></a>train_df <span class="ot">&lt;-</span> df[train.ID, ]</span>
<span id="cb94-6"><a href="DA.html#cb94-6" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> df[<span class="sc">-</span>train.ID, ]</span>
<span id="cb94-7"><a href="DA.html#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="DA.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos como control una validación cruzada con 10 hojas, sin repeticiones</span></span>
<span id="cb94-9"><a href="DA.html#cb94-9" aria-hidden="true" tabindex="-1"></a>fit_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">&#39;cv&#39;</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb94-10"><a href="DA.html#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="DA.html#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb94-12"><a href="DA.html#cb94-12" aria-hidden="true" tabindex="-1"></a>model_lda_def <span class="ot">&lt;-</span> <span class="fu">train</span>(default <span class="sc">~</span>.,</span>
<span id="cb94-13"><a href="DA.html#cb94-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_df,</span>
<span id="cb94-14"><a href="DA.html#cb94-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;lda&quot;</span>,</span>
<span id="cb94-15"><a href="DA.html#cb94-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> fit_control)</span>
<span id="cb94-16"><a href="DA.html#cb94-16" aria-hidden="true" tabindex="-1"></a>model_lda_def</span></code></pre></div>
<pre><code>## Linear Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results:
## 
##   Accuracy  Kappa    
##   0.973379  0.3710518</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="DA.html#cb96-1" aria-hidden="true" tabindex="-1"></a>model_lda_def<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Call:
## lda(x, grouping = y)
## 
## Prior probabilities of groups:
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Group means:
##       income   balance
## No  33513.73  805.9109
## Yes 32450.16 1753.3628
## 
## Coefficients of linear discriminants:
##                  LD1
## income  9.334558e-06
## balance 2.233976e-03</code></pre>
<p>La precisión durante el entrenamiento es de un <span class="math inline">\(\approx 97\%\)</span>. También vemos que las probabilidades a priori <span class="math inline">\(\pi_i, i = 1,2\)</span> de pertenecer a cada clase son aproximadamente <span class="math inline">\(97\%\)</span> y <span class="math inline">\(3\%\)</span> respectivamente, lo cual corresponde a la razón de fallo que se comenta al inicio. El resultado <code>Coefficients of linear discriminants</code> indica las constantes que se multiplican a cada elemento de la muestra <span class="math inline">\((\text{income}_i, \text{balance}_i)\)</span>, <span class="math inline">\(i = 1, \ldots, n_{\text{train}}\)</span>, para obtener su correspondiente valor de la <em>función discriminante lineal</em>:
<span class="math display">\[ \delta_k(x) = x^T \Sigma^{-1} \mu_k  - \dfrac{1}{2} \mu_k^T \Sigma^{-1} \mu_k+ log(\pi_k) \]</span>
Todo indica que la variable <code>balance</code> tiene un mayor peso en la discriminación. Como alternativa, podemos comprobarlo usando <code>varImp</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="DA.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(model_lda_def)</span></code></pre></div>
<pre><code>## ROC curve variable importance
## 
##         Importance
## balance        100
## income           0</code></pre>
<p>Veamos ahora qué tal es el ajuste en los datos test.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="DA.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hagamos las predicciones del conjunto de prueba</span></span>
<span id="cb100-2"><a href="DA.html#cb100-2" aria-hidden="true" tabindex="-1"></a>prediction_lda_def <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lda_def, <span class="at">newdata =</span> test_df)</span>
<span id="cb100-3"><a href="DA.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_lda_def, <span class="at">reference =</span> test_df<span class="sc">$</span>default)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   No  Yes
##        No  1927   54
##        Yes    6   12
##                                          
##                Accuracy : 0.97           
##                  95% CI : (0.9615, 0.977)
##     No Information Rate : 0.967          
##     P-Value [Acc &gt; NIR] : 0.2488         
##                                          
##                   Kappa : 0.2755         
##                                          
##  Mcnemar&#39;s Test P-Value : 1.298e-09      
##                                          
##             Sensitivity : 0.9969         
##             Specificity : 0.1818         
##          Pos Pred Value : 0.9727         
##          Neg Pred Value : 0.6667         
##              Prevalence : 0.9670         
##          Detection Rate : 0.9640         
##    Detection Prevalence : 0.9910         
##       Balanced Accuracy : 0.5894         
##                                          
##        &#39;Positive&#39; Class : No             
## </code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="DA.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extraemos el Accuracy o Precisión</span></span>
<span id="cb102-2"><a href="DA.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_lda_def, <span class="at">reference =</span> test_df<span class="sc">$</span>default)<span class="sc">$</span>overall[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Accuracy 
## 0.969985</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="DA.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la tasa de error</span></span>
<span id="cb104-2"><a href="DA.html#cb104-2" aria-hidden="true" tabindex="-1"></a>tasa.error.lda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">confusionMatrix</span>(prediction_lda_def, <span class="at">reference =</span> test_df<span class="sc">$</span>default)<span class="sc">$</span>overall[<span class="dv">1</span>]</span>
<span id="cb104-3"><a href="DA.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tasa.error.lda) <span class="ot">&lt;-</span> <span class="st">&quot;Error LDA&quot;</span></span>
<span id="cb104-4"><a href="DA.html#cb104-4" aria-hidden="true" tabindex="-1"></a>tasa.error.lda</span></code></pre></div>
<pre><code>##  Error LDA 
## 0.03001501</code></pre>
<p>Vemos que la especificidad es muy buena (casi no falla al clasificar los verdaderos “No”), pero la sensibilidad (capacidad para detectar los verdaderos “Yes”) es muy mala. Vamos a cambiar el umbral de decisión (por defecto probabilidad <span class="math inline">\(0.5\)</span>) para intentar mejorar el algoritmo para protegernos de los malos pagadores:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="DA.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predecimos las probabilidades:</span></span>
<span id="cb106-2"><a href="DA.html#cb106-2" aria-hidden="true" tabindex="-1"></a>prediction_lda_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lda_def, </span>
<span id="cb106-3"><a href="DA.html#cb106-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">newdata =</span> test_df, </span>
<span id="cb106-4"><a href="DA.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)</span>
<span id="cb106-5"><a href="DA.html#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="DA.html#cb106-6" aria-hidden="true" tabindex="-1"></a>prediction_lda_def <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(</span>
<span id="cb106-7"><a href="DA.html#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(prediction_lda_prob<span class="sc">$</span>Yes <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)</span>
<span id="cb106-8"><a href="DA.html#cb106-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-9"><a href="DA.html#cb106-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-10"><a href="DA.html#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="DA.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_lda_def, </span>
<span id="cb106-12"><a href="DA.html#cb106-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> test_df<span class="sc">$</span>default, </span>
<span id="cb106-13"><a href="DA.html#cb106-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb106-14"><a href="DA.html#cb106-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">mode =</span> <span class="st">&quot;everything&quot;</span>)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   No  Yes
##        No  1885   32
##        Yes   48   34
##                                           
##                Accuracy : 0.96            
##                  95% CI : (0.9504, 0.9681)
##     No Information Rate : 0.967           
##     P-Value [Acc &gt; NIR] : 0.96205         
##                                           
##                   Kappa : 0.4389          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.09353         
##                                           
##             Sensitivity : 0.51515         
##             Specificity : 0.97517         
##          Pos Pred Value : 0.41463         
##          Neg Pred Value : 0.98331         
##               Precision : 0.41463         
##                  Recall : 0.51515         
##                      F1 : 0.45946         
##              Prevalence : 0.03302         
##          Detection Rate : 0.01701         
##    Detection Prevalence : 0.04102         
##       Balanced Accuracy : 0.74516         
##                                           
##        &#39;Positive&#39; Class : Yes             
## </code></pre>
<div id="frontera-de-decisión-en-2d" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Frontera de decisión en 2D</h3>
<p>Como estamos en un problema de clasificación en dos dimensiones (<span class="math inline">\(p = 2\)</span>), es posible representar la frontera de decisión del algoritmo, usando la función <code>decision_bound</code>. Debemos modificar los campos para que coincidan con las variables de <code>Default</code>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="DA.html#cb108-1" aria-hidden="true" tabindex="-1"></a>decision_bound <span class="ot">=</span> <span class="cf">function</span>(train_df_in, test_df_in, model_in){</span>
<span id="cb108-2"><a href="DA.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot decision boundary  for df &lt;- Default[, c(&quot;income&quot;, &quot;balance&quot;, &quot;default&quot;)]</span></span>
<span id="cb108-3"><a href="DA.html#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="DA.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(MASS)</span>
<span id="cb108-5"><a href="DA.html#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(caret)</span>
<span id="cb108-6"><a href="DA.html#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(ggplot2)</span>
<span id="cb108-7"><a href="DA.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(gridExtra)</span>
<span id="cb108-8"><a href="DA.html#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="DA.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 1: crear un grid de valores desde min a max de ambos predictores</span></span>
<span id="cb108-10"><a href="DA.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  pl <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(train_df_in<span class="sc">$</span>balance), <span class="fu">max</span>(train_df_in<span class="sc">$</span>balance), <span class="at">length.out =</span> <span class="dv">80</span>)</span>
<span id="cb108-11"><a href="DA.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  pw <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(train_df_in<span class="sc">$</span>income), <span class="fu">max</span>(train_df_in<span class="sc">$</span>income), <span class="at">length.out =</span> <span class="dv">80</span>)</span>
<span id="cb108-12"><a href="DA.html#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="DA.html#cb108-13" aria-hidden="true" tabindex="-1"></a>  lgrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">balance=</span>pl, <span class="at">income=</span>pw)</span>
<span id="cb108-14"><a href="DA.html#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="DA.html#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 2: obtener las predicciones tanto para el grid como para el test</span></span>
<span id="cb108-16"><a href="DA.html#cb108-16" aria-hidden="true" tabindex="-1"></a>  modelPredGrid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_in, <span class="at">newdata=</span>lgrid)</span>
<span id="cb108-17"><a href="DA.html#cb108-17" aria-hidden="true" tabindex="-1"></a>  train_df_in<span class="sc">$</span>Pred.Class <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_in, <span class="at">newdata =</span> train_df_in)</span>
<span id="cb108-18"><a href="DA.html#cb108-18" aria-hidden="true" tabindex="-1"></a>  test_df_in<span class="sc">$</span>Pred.Class <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_in, <span class="at">newdata =</span> test_df_in)</span>
<span id="cb108-19"><a href="DA.html#cb108-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-20"><a href="DA.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Paso 3: ggplot con la funcion contour</span></span>
<span id="cb108-21"><a href="DA.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>lgrid) <span class="sc">+</span></span>
<span id="cb108-22"><a href="DA.html#cb108-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_contour</span>(<span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income, <span class="at">z=</span><span class="fu">as.numeric</span>(modelPredGrid)), <span class="at">bins=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb108-23"><a href="DA.html#cb108-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income, <span class="at">colour=</span>modelPredGrid), <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb108-24"><a href="DA.html#cb108-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Clases&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Train&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-25"><a href="DA.html#cb108-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>train_df_in,</span>
<span id="cb108-26"><a href="DA.html#cb108-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income,</span>
<span id="cb108-27"><a href="DA.html#cb108-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span>default), <span class="at">size=</span><span class="dv">5</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-28"><a href="DA.html#cb108-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>()</span>
<span id="cb108-29"><a href="DA.html#cb108-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-30"><a href="DA.html#cb108-30" aria-hidden="true" tabindex="-1"></a>  gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>lgrid) <span class="sc">+</span></span>
<span id="cb108-31"><a href="DA.html#cb108-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_contour</span>(<span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income, <span class="at">z=</span><span class="fu">as.numeric</span>(modelPredGrid)), <span class="at">bins=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb108-32"><a href="DA.html#cb108-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income, <span class="at">colour=</span>modelPredGrid), <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb108-33"><a href="DA.html#cb108-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;Clases&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Test&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-34"><a href="DA.html#cb108-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>test_df_in,</span>
<span id="cb108-35"><a href="DA.html#cb108-35" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>income,</span>
<span id="cb108-36"><a href="DA.html#cb108-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">colour=</span>default), <span class="at">size=</span><span class="dv">5</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-37"><a href="DA.html#cb108-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>()</span>
<span id="cb108-38"><a href="DA.html#cb108-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.arrange</span>(gg1, gg2, <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb108-39"><a href="DA.html#cb108-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="DA.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decision_bound</span>(train_df, test_df, model_lda_def)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="QDA" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Análisis Discriminante Cuadrático</h2>
<p>El ajuste para el modelo QDA lo hacemos con el mismo control y la misma partición de la muestra.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="DA.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb110-2"><a href="DA.html#cb110-2" aria-hidden="true" tabindex="-1"></a>model_qda_def <span class="ot">&lt;-</span> <span class="fu">train</span>(default <span class="sc">~</span>.,</span>
<span id="cb110-3"><a href="DA.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_df,</span>
<span id="cb110-4"><a href="DA.html#cb110-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;qda&quot;</span>,</span>
<span id="cb110-5"><a href="DA.html#cb110-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> fit_control)</span>
<span id="cb110-6"><a href="DA.html#cb110-6" aria-hidden="true" tabindex="-1"></a>model_qda_def</span></code></pre></div>
<pre><code>## Quadratic Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results:
## 
##   Accuracy   Kappa    
##   0.9730043  0.3787741</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="DA.html#cb112-1" aria-hidden="true" tabindex="-1"></a>model_qda_def<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Call:
## qda(x, grouping = y)
## 
## Prior probabilities of groups:
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Group means:
##       income   balance
## No  33513.73  805.9109
## Yes 32450.16 1753.3628</code></pre>
<p>Los resultados al entrenar son similares al caso LDA. Veamos las predicciones para la muestra test.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="DA.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hagamos las predicciones del conjunto de prueba</span></span>
<span id="cb114-2"><a href="DA.html#cb114-2" aria-hidden="true" tabindex="-1"></a>prediction_qda_def <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_qda_def, <span class="at">newdata =</span> test_df)</span>
<span id="cb114-3"><a href="DA.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_qda_def, </span>
<span id="cb114-4"><a href="DA.html#cb114-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> test_df<span class="sc">$</span>default, </span>
<span id="cb114-5"><a href="DA.html#cb114-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb114-6"><a href="DA.html#cb114-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">mode =</span> <span class="st">&quot;everything&quot;</span>)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   No  Yes
##        No  1924   51
##        Yes    9   15
##                                          
##                Accuracy : 0.97           
##                  95% CI : (0.9615, 0.977)
##     No Information Rate : 0.967          
##     P-Value [Acc &gt; NIR] : 0.2488         
##                                          
##                   Kappa : 0.3214         
##                                          
##  Mcnemar&#39;s Test P-Value : 1.203e-07      
##                                          
##             Sensitivity : 0.227273       
##             Specificity : 0.995344       
##          Pos Pred Value : 0.625000       
##          Neg Pred Value : 0.974177       
##               Precision : 0.625000       
##                  Recall : 0.227273       
##                      F1 : 0.333333       
##              Prevalence : 0.033017       
##          Detection Rate : 0.007504       
##    Detection Prevalence : 0.012006       
##       Balanced Accuracy : 0.611308       
##                                          
##        &#39;Positive&#39; Class : Yes            
## </code></pre>
<p>Notamos un rendimiento similar, con cierta mejora de la precisión y la sensibilidad. Finalmente, representamos la frontera de decisión del algoritmo.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="DA.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decision_bound</span>(train_df, test_df, model_qda_def)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>¡Ahora observamos que las regiones están separadas por curvas, en lugar de la recta del LDA!</p>
</div>
<div id="RDA" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Análisis Discriminante Regularizado</h2>
<p><strong>Opción 1</strong>: el paquete <code>caret</code> crea el grid para <span class="math inline">\((\lambda, \gamma)\)</span>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="DA.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb117-2"><a href="DA.html#cb117-2" aria-hidden="true" tabindex="-1"></a>model_rda_def <span class="ot">&lt;-</span> <span class="fu">train</span>(default <span class="sc">~</span>.,</span>
<span id="cb117-3"><a href="DA.html#cb117-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_df,</span>
<span id="cb117-4"><a href="DA.html#cb117-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;rda&quot;</span>,</span>
<span id="cb117-5"><a href="DA.html#cb117-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneLength =</span> <span class="dv">2</span>,</span>
<span id="cb117-6"><a href="DA.html#cb117-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> fit_control)</span>
<span id="cb117-7"><a href="DA.html#cb117-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-8"><a href="DA.html#cb117-8" aria-hidden="true" tabindex="-1"></a>model_rda_def</span></code></pre></div>
<pre><code>## Regularized Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results across tuning parameters:
## 
##   gamma  lambda  Accuracy   Kappa    
##   0      0       0.9730043  0.3787741
##   0      1       0.9733790  0.3710518
##   1      0       0.9666297  0.0000000
##   1      1       0.9666297  0.0000000
## 
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were gamma = 0 and lambda = 1.</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="DA.html#cb119-1" aria-hidden="true" tabindex="-1"></a>model_rda_def<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Call: 
## rda.default(x = x, grouping = y, gamma = param$gamma, lambda = param$lambda)
## 
## Regularization parameters: 
##  gamma lambda 
##      0      1 
## 
## Prior probabilities of groups: 
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Misclassification rate: 
##        apparent: 2.662 %</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="DA.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en este caso el ggplot nos da información sobre los </span></span>
<span id="cb121-2"><a href="DA.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hiperparametros y su correspondiente Accuracy</span></span>
<span id="cb121-3"><a href="DA.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model_rda_def) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Opción 2</strong>: podemos proporcionar un grid predefinido de valores <span class="math inline">\((\lambda, \gamma)\)</span> en un <code>data.frame</code> que le pasamos a <code>tuneGrid</code>:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="DA.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># el grid se puede definir tambien &quot;a mano&quot;</span></span>
<span id="cb122-2"><a href="DA.html#cb122-2" aria-hidden="true" tabindex="-1"></a>mi.grid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lambda =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="dv">1</span>) , </span>
<span id="cb122-3"><a href="DA.html#cb122-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">gamma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb122-4"><a href="DA.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb122-5"><a href="DA.html#cb122-5" aria-hidden="true" tabindex="-1"></a>model_rda_def <span class="ot">&lt;-</span> <span class="fu">train</span>(default <span class="sc">~</span>.,</span>
<span id="cb122-6"><a href="DA.html#cb122-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> train_df,</span>
<span id="cb122-7"><a href="DA.html#cb122-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;rda&quot;</span>,</span>
<span id="cb122-8"><a href="DA.html#cb122-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tuneGrid =</span> mi.grid,</span>
<span id="cb122-9"><a href="DA.html#cb122-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trControl =</span> fit_control)</span>
<span id="cb122-10"><a href="DA.html#cb122-10" aria-hidden="true" tabindex="-1"></a>model_rda_def</span></code></pre></div>
<pre><code>## Regularized Discriminant Analysis 
## 
## 8001 samples
##    2 predictor
##    2 classes: &#39;No&#39;, &#39;Yes&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 7200, 7200, 7201, 7202, 7201, 7202, ... 
## Resampling results across tuning parameters:
## 
##   lambda  Accuracy   Kappa    
##   0.0     0.9730043  0.3787741
##   0.3     0.9733790  0.3791078
##   0.6     0.9735039  0.3764691
##   1.0     0.9733790  0.3710518
## 
## Tuning parameter &#39;gamma&#39; was held constant at a value of 0
## Accuracy was used to select the optimal model using the largest value.
## The final values used for the model were gamma = 0 and lambda = 0.6.</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="DA.html#cb124-1" aria-hidden="true" tabindex="-1"></a>model_rda_def<span class="sc">$</span>finalModel</span></code></pre></div>
<pre><code>## Call: 
## rda.default(x = x, grouping = y, gamma = param$gamma, lambda = param$lambda)
## 
## Regularization parameters: 
##  gamma lambda 
##    0.0    0.6 
## 
## Prior probabilities of groups: 
##         No        Yes 
## 0.96662917 0.03337083 
## 
## Misclassification rate: 
##        apparent: 2.675 %</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="DA.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en este caso el ggplot nos da información sobre los </span></span>
<span id="cb126-2"><a href="DA.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hiperparametros y su correspondiente Accuracy</span></span>
<span id="cb126-3"><a href="DA.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model_rda_def) <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Los resultados indican que los hiperparámetros óptimos en este caso corresponden a <span class="math inline">\((\lambda, \gamma) = (0.6, 0)\)</span>. Esto que hemos hecho es comparar diferentes modelos (porque han sido ajustados con diferentes hiperparámetros) resultantes del mismo algoritmo. Veamos las predicciones para la muestra test, la tasa de error correspondiente y la frontera de decisión.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="DA.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hagamos las predicciones del conjunto de prueba</span></span>
<span id="cb127-2"><a href="DA.html#cb127-2" aria-hidden="true" tabindex="-1"></a>prediction_rda_def <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_rda_def, <span class="at">newdata =</span> test_df)</span>
<span id="cb127-3"><a href="DA.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_rda_def, </span>
<span id="cb127-4"><a href="DA.html#cb127-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> test_df<span class="sc">$</span>default, </span>
<span id="cb127-5"><a href="DA.html#cb127-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">&quot;Yes&quot;</span>, </span>
<span id="cb127-6"><a href="DA.html#cb127-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">mode =</span> <span class="st">&quot;everything&quot;</span>)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   No  Yes
##        No  1926   52
##        Yes    7   14
##                                           
##                Accuracy : 0.9705          
##                  95% CI : (0.9621, 0.9775)
##     No Information Rate : 0.967           
##     P-Value [Acc &gt; NIR] : 0.2098          
##                                           
##                   Kappa : 0.3109          
##                                           
##  Mcnemar&#39;s Test P-Value : 1.014e-08       
##                                           
##             Sensitivity : 0.212121        
##             Specificity : 0.996379        
##          Pos Pred Value : 0.666667        
##          Neg Pred Value : 0.973711        
##               Precision : 0.666667        
##                  Recall : 0.212121        
##                      F1 : 0.321839        
##              Prevalence : 0.033017        
##          Detection Rate : 0.007004        
##    Detection Prevalence : 0.010505        
##       Balanced Accuracy : 0.604250        
##                                           
##        &#39;Positive&#39; Class : Yes             
## </code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="DA.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extraemos el Accuracy o Precisión</span></span>
<span id="cb129-2"><a href="DA.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediction_rda_def, <span class="at">reference =</span> test_df<span class="sc">$</span>default)<span class="sc">$</span>overall[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>##  Accuracy 
## 0.9704852</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="DA.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la tasa de error</span></span>
<span id="cb131-2"><a href="DA.html#cb131-2" aria-hidden="true" tabindex="-1"></a>tasa.error.rda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">confusionMatrix</span>(prediction_rda_def, <span class="at">reference =</span> test_df<span class="sc">$</span>default)<span class="sc">$</span>overall[<span class="dv">1</span>]</span>
<span id="cb131-3"><a href="DA.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tasa.error.rda) <span class="ot">&lt;-</span> <span class="st">&quot;Error RDA&quot;</span></span>
<span id="cb131-4"><a href="DA.html#cb131-4" aria-hidden="true" tabindex="-1"></a>tasa.error.rda</span></code></pre></div>
<pre><code>##  Error RDA 
## 0.02951476</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="DA.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decision_bound</span>(train_df, test_df, model_rda_def)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="k-vecinos-más-próximos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="compara.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
